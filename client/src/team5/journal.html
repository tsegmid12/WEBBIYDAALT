<!DOCTYPE html>
<html lang="mn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Багшийн Журнал</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ===== BASE STYLES ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        :root {
            --primary-bg: #ffffff;
            --text-color: #330000;
            --header-bg: #e0e0e0;
            --button-bg: #b9c9ed;
            --button-hover: #9fc9ed;
            --footer-bg: #1a237e;
            --card-bg: white;
            --table-header: #fff9c4;
            --error-color: #ff4444;
            --border-color: #ddd;
        }
        
        body {
            background-color: var(--primary-bg);
            color: var(--text-color);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        /* ===== HEADER STYLES ===== */
        .header {
            background-color: var(--header-bg);
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .menu-btn {
            font-size: 24px;
            background: none;
            border: none;
            cursor: pointer;
            color: var(--text-color);
            padding: 5px 10px;
            border-radius: 4px;
            transition: background-color 0.3s;
        }
        
        .menu-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .notification-btn {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: var(--text-color);
            position: relative;
        }
        
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: var(--error-color);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            background-color: #a0a0a0;
            border-radius: 50%;
        }
        
        /* ===== MAIN CONTENT STYLES ===== */
        .main-content {
            flex: 1;
            padding: 30px;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
        }
        
        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
        }
        
        .page-title {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .page-subtitle {
            color: #666;
            margin-bottom: 10px;
        }
        
        .course-info {
            background-color: #e8e8e8;
            padding: 12px 20px;
            border-radius: 10px;
            display: inline-block;
            margin-bottom: 15px;
            font-weight: 500;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .action-bar {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .action-btn {
            background-color: var(--button-bg);
            color: var(--text-color);
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            transition: background-color 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .action-btn:hover {
            background-color: var(--button-hover);
        }
        
        .content-card {
            background-color: var(--card-bg);
            border-radius: 15px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            overflow: hidden;
            border: 1px solid var(--border-color);
        }
        
        .table-container {
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: center;
            border: 1px solid var(--border-color);
        }
        
        th {
            background-color: var(--table-header);
            font-weight: bold;
        }
        
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        tr:hover {
            background-color: #fffde7;
        }
        
        .grade-input {
            width: 60px;
            padding: 5px;
            text-align: center;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        
        .grade-input.error {
            border-color: var(--error-color);
            background-color: #ffe6e6;
        }
        
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }
        
        .btn {
            background-color: var(--button-bg);
            color: var(--text-color);
            border: none;
            padding: 12px 25px;
            border-radius: 20px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 3px 5px rgba(0,0,0,0.2);
            transition: background-color 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn:hover {
            background-color: var(--button-hover);
        }
        
        .btn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        
        .error-message {
            color: var(--error-color);
            font-size: 12px;
            margin-top: 5px;
            display: none;
        }
        
        /* ===== FOOTER STYLES ===== */
        .footer {
            background-color: var(--footer-bg);
            color: white;
            text-align: center;
            padding: 25px 20px;
            margin-top: 40px;
        }
        
        .footer p {
            margin: 5px 0;
        }
        
        /* ===== SIDEBAR STYLES ===== */
        .overlay-menu {
            position: fixed;
            top: 0;
            left: 0;
            width: 50%;
            height: 100%;
            background-color: #f5f5f5;
            z-index: 1000;
            display: none;
            flex-direction: column;
            box-shadow: 2px 0 10px rgba(0,0,0,0.2);
        }
        
        .menu-header {
            background-color: var(--header-bg);
            padding: 20px;
            font-size: 22px;
            font-weight: bold;
            border-bottom: 1px solid #ccc;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .back-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-color);
            padding: 5px 10px;
            border-radius: 4px;
            transition: background-color 0.3s;
        }
        
        .back-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        
        .settings-btn {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: var(--text-color);
        }
        
        .menu-items {
            flex: 1;
            padding: 30px;
        }
        
        .menu-item {
            padding: 20px 0;
            font-size: 18px;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            transition: color 0.3s, background-color 0.3s;
            padding-left: 15px;
            border-radius: 5px;
        }
        
        .menu-item:hover {
            color: var(--footer-bg);
            background-color: #e8e8e8;
        }
        
        .overlay-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 999;
            display: none;
        }
        
        /* ===== RESPONSIVE STYLES ===== */
        @media (max-width: 768px) {
            .overlay-menu {
                width: 80%;
            }
            
            .header {
                padding: 12px 20px;
            }
            
            .main-content {
                padding: 20px;
            }
            
            .page-header {
                flex-direction: column;
                gap: 15px;
            }
            
            .action-bar {
                flex-wrap: wrap;
            }
            
            .action-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 80%;
                justify-content: center;
            }
            
            th, td {
                padding: 8px 10px;
                font-size: 12px;
            }
        }
        
        @media (max-width: 480px) {
            .overlay-menu {
                width: 85%;
            }
            
            .menu-item {
                font-size: 16px;
                padding: 15px 0;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <button class="menu-btn" id="menuBtn">
            <i class="fas fa-bars"></i>
        </button>
        <div class="user-info">
            <button class="notification-btn">
                <i class="fas fa-bell"></i>
                <span class="notification-badge">3</span>
            </button>
            <span>Хэрэглэгчийн нэр</span>
            <div class="user-avatar"></div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div class="page-header">
            <div>
                <h1 class="page-title">Багшийн журнал</h1>
                <p class="page-subtitle">Бүх сургалтын дүнг оруулах</p>
                <div class="course-info">
                    Хичээл: Веб зохиомж Код: FSA.316
                </div>
            </div>
            <div class="action-bar">
                <button class="action-btn">
                    <i class="fas fa-filter"></i> Filter
                </button>
                <button class="action-btn">
                    <i class="fas fa-file-export"></i> Export
                </button>
                <button class="action-btn">
                    <i class="fas fa-exchange-alt"></i> Хичээл солих
                </button>
            </div>
        </div>
        
        <div class="content-card">
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Сурагчийн код</th>
                            <th>Сурагчийн нэр</th>
                            <th>Кредит</th>
                            <th>Б.Оноо (0-70)</th>
                            <th>Шал.Оноо (0-30)</th>
                            <th>Оноо (0-100)</th>
                            <th>Үнэлгээ</th>
                            <th>Чансаа</th>
                            <th>Багш.код</th>
                            <th>Багшийн нэр</th>
                        </tr>
                    </thead>
                    <tbody id="studentTable">
                        <!-- Student data will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
        
        <div class="action-buttons">
            <button class="btn" id="graphBtn">
                <i class="fas fa-chart-bar"></i> Графаар харах
            </button>
            <button class="btn" id="editBtn">
                <i class="fas fa-edit"></i> Дүн шинэчлэх
            </button>
            <button class="btn" id="saveBtn" disabled>
                <i class="fas fa-save"></i> Дүн хадгалах
            </button>
        </div>
        
        <div class="error-message" id="errorMessage"></div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <p>© 2024 Class Technologies Inc.</p>
        <p>Нууцлалын бодлого | Үйлчилгээний нөхцөл</p>
        <p>Сургуулийн нэр</p>
    </footer>

    <!-- Half-screen Overlay Menu -->
    <div class="overlay-backdrop" id="overlayBackdrop"></div>
    <div class="overlay-menu" id="overlayMenu">
        <div class="menu-header">
            <button class="back-btn" id="backBtn">
                <i class="fas fa-chevron-left"></i>
            </button>
            <span>Багшийн самбар</span>
            <button class="settings-btn">
                <i class="fas fa-cog"></i>
            </button>
        </div>
        <div class="menu-items">
            <div class="menu-item">Багшийн самбар</div>
            <div class="menu-item">Оюутны дүн харах</div>
            <div class="menu-item">Ирц бүртгэх</div>
            <div class="menu-item">Хүсэлт баталгаажуулах</div>
            <div class="menu-item">Хуваарь</div>
            <div class="menu-item">Гарах</div>
        </div>
    </div>

    <script>
        // Student data - Load from localStorage or use default
        let students = JSON.parse(localStorage.getItem('students')) || [
            { code: "B22327001", name: "Сараа", credit: "3 кр", baseScore: 70, examScore: 28 },
            { code: "B22327002", name: "Номио", credit: "3 кр", baseScore: 59, examScore: 27 },
            { code: "B22327003", name: "Тулгаа", credit: "3 кр", baseScore: 64, examScore: 26 },
            { code: "B22327004", name: "Цэцэгээ", credit: "3 кр", baseScore: 54, examScore: 30 },
            { code: "B22327005", name: "Наранцацрал", credit: "3 кр", baseScore: 68, examScore: 25 },
            { code: "B22327006", name: "Энхжин", credit: "3 кр", baseScore: 65, examScore: 25 },
            { code: "B22327007", name: "Ялалт", credit: "3 кр", baseScore: 61, examScore: 29 },
            { code: "B22327008", name: "Жавхлан", credit: "3 кр", baseScore: 58, examScore: 26 }
        ];

        // Save students data to localStorage
        function saveStudentsToLocalStorage() {
            localStorage.setItem('students', JSON.stringify(students));
        }

        // Function to calculate grades
        function calculateGrades(base, exam) {
            const total = base + exam;
            let grade, rank;
            
            if (total >= 95) { grade = "A+"; rank = 12; }
            else if (total >= 90) { grade = "A"; rank = 11; }
            else if (total >= 80) { grade = "B"; rank = 10; }
            else if (total >= 70) { grade = "C"; rank = 9; }
            else if (total >= 60) { grade = "D"; rank = 8; }
            else { grade = "F"; rank = 0; }
            
            return { total, grade, rank };
        }

        // Function to update a student row
        function updateStudentRow(row, base, exam) {
            const { total, grade, rank } = calculateGrades(base, exam);
            
            row.cells[5].textContent = total;  // Оноо
            row.cells[6].textContent = grade;  // Үнэлгээ
            row.cells[7].textContent = rank;   // Чансаа
        }

        // Function to validate input
        function validateInput(base, exam, studentName) {
            const errorMessage = document.getElementById('errorMessage');
            
            if (base > 70) {
                errorMessage.textContent = `Алдаа: ${studentName}-ийн Б.Оноо 70-ээс их байна!`;
                errorMessage.style.display = 'block';
                return false;
            }
            
            if (exam > 30) {
                errorMessage.textContent = `Алдаа: ${studentName}-ийн Шал.Оноо 30-аас их байна!`;
                errorMessage.style.display = 'block';
                return false;
            }
            
            if (base + exam > 100) {
                errorMessage.textContent = `Алдаа: ${studentName}-ийн нийт оноо 100-аас их байна!`;
                errorMessage.style.display = 'block';
                return false;
            }
            
            errorMessage.style.display = 'none';
            return true;
        }

        // Function to populate student table
        function populateStudentTable() {
            const studentTable = document.getElementById('studentTable');
            studentTable.innerHTML = '';
            
            students.forEach(student => {
                const { total, grade, rank } = calculateGrades(student.baseScore, student.examScore);
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${student.code}</td>
                    <td>${student.name}</td>
                    <td>${student.credit}</td>
                    <td class="editable">${student.baseScore}</td>
                    <td class="editable">${student.examScore}</td>
                    <td>${total}</td>
                    <td>${grade}</td>
                    <td>${rank}</td>
                    <td>FITM301</td>
                    <td>Ц.Сарангуа</td>
                `;
                studentTable.appendChild(row);
            });
        }

        // Initial population of student table
        populateStudentTable();

        // Menu functionality
        const menuBtn = document.getElementById('menuBtn');
        const backBtn = document.getElementById('backBtn');
        const overlayMenu = document.getElementById('overlayMenu');
        const overlayBackdrop = document.getElementById('overlayBackdrop');
        
        function openMenu() {
            overlayMenu.style.display = 'flex';
            overlayBackdrop.style.display = 'block';
            document.body.style.overflow = 'hidden';
        }
        
        function closeMenu() {
            overlayMenu.style.display = 'none';
            overlayBackdrop.style.display = 'none';
            document.body.style.overflow = 'auto';
        }
        
        menuBtn.addEventListener('click', openMenu);
        backBtn.addEventListener('click', closeMenu);
        overlayBackdrop.addEventListener('click', closeMenu);
        
        // Close menu when clicking on menu items
        const menuItems = document.querySelectorAll('.menu-item');
        menuItems.forEach(item => {
            item.addEventListener('click', closeMenu);
        });

        // Settings button in menu
        document.querySelector('.settings-btn').addEventListener('click', function() {
            alert('Тохиргооны цэс нээгдлээ');
        });

        // Notification button
        document.querySelector('.notification-btn').addEventListener('click', function() {
            alert('Таны 3 шинэ мэдэгдэл байна');
        });
        
        // Edit/Save functionality for grades
        const editBtn = document.getElementById('editBtn');
        const saveBtn = document.getElementById('saveBtn');
        let isEditing = false;
        
        editBtn.addEventListener('click', function() {
            if (isEditing) return;
            
            isEditing = true;
            saveBtn.disabled = false;
            
            document.querySelectorAll('tbody tr').forEach((row, index) => {
                const baseCell = row.cells[3];
                const examCell = row.cells[4];
                const studentName = row.cells[1].textContent;
                
                const baseValue = baseCell.textContent;
                const examValue = examCell.textContent;
                
                // Save current values to data attributes
                baseCell.setAttribute('data-original', baseValue);
                examCell.setAttribute('data-original', examValue);
                
                baseCell.innerHTML = `<input type="number" value="${baseValue}" class="grade-input base-input" min="0" max="70" data-student="${studentName}" data-index="${index}">`;
                examCell.innerHTML = `<input type="number" value="${examValue}" class="grade-input exam-input" min="0" max="30" data-student="${studentName}" data-index="${index}">`;
                
                // Add event listeners to update grades in real-time
                const baseInput = baseCell.querySelector('.base-input');
                const examInput = examCell.querySelector('.exam-input');
                
                const updateHandler = () => {
                    const base = parseInt(baseInput.value) || 0;
                    const exam = parseInt(examInput.value) || 0;
                    
                    // Validate input
                    const isValid = validateInput(base, exam, studentName);
                    
                    if (isValid) {
                        baseInput.classList.remove('error');
                        examInput.classList.remove('error');
                        updateStudentRow(row, base, exam);
                        saveBtn.disabled = false;
                    } else {
                        baseInput.classList.add('error');
                        examInput.classList.add('error');
                        saveBtn.disabled = true;
                    }
                };
                
                baseInput.addEventListener('input', updateHandler);
                examInput.addEventListener('input', updateHandler);
            });
        });
        
        saveBtn.addEventListener('click', function() {
            let hasError = false;
            
            document.querySelectorAll('tbody tr').forEach((row, index) => {
                const baseCell = row.cells[3];
                const examCell = row.cells[4];
                const studentName = row.cells[1].textContent;
                
                const baseInput = baseCell.querySelector('.base-input');
                const examInput = examCell.querySelector('.exam-input');
                
                const base = parseInt(baseInput.value) || 0;
                const exam = parseInt(examInput.value) || 0;
                
                // Final validation before saving
                if (!validateInput(base, exam, studentName)) {
                    hasError = true;
                    return;
                }
                
                // Update the students array with new values
                students[index].baseScore = base;
                students[index].examScore = exam;
                
                // Convert back to text (not editable)
                baseCell.textContent = base;
                examCell.textContent = exam;
                
                // Remove data attributes
                baseCell.removeAttribute('data-original');
                examCell.removeAttribute('data-original');
            });
            
            if (!hasError) {
                isEditing = false;
                saveBtn.disabled = true;
                document.getElementById('errorMessage').style.display = 'none';
                alert('Дүн амжилттай хадгалагдлаа!');
                
                // Save to localStorage
                saveStudentsToLocalStorage();
            }
        });
        
        // Graph button functionality - Navigate to gradeGraph.html
        document.getElementById('graphBtn').addEventListener('click', function() {
            // Save current data to localStorage before navigating
            saveStudentsToLocalStorage();
            window.location.href = 'gradeGraph.html';
        });

        // Action buttons functionality
        document.querySelectorAll('.action-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const text = this.textContent.trim();
                alert(`${text} функц идэвхжлээ`);
            });
        });
    </script>
</body>
</html>